"use strict";var _classCallCheck=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function t(t,i){for(var n=0;n<i.length;n++){var s=i[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,n,s){return n&&t(i.prototype,n),s&&t(i,s),i}}();!function(t){function i(t){this.subscriptions[t.box]=this.subscriptions[t.box].filter(function(i){return i.id!==t.id}),0===this.subscriptions[t.box].length&&delete this.subscriptions[t.box]}function n(t){return t.toString().replace(/(^\/|\/$)/g,"")}function s(t,i){var n=[];return function(s){return s.forEach(function(i){n.push(i.handler(t))}),i(n)}}function e(t,i){return t&&{}.toString.call(t)==="[object "+i+"]"}var r=function(){function t(){_classCallCheck(this,t),this.subscriptions={}}return _createClass(t,[{key:"receive",value:function(t,n){var s=new c(t,n);return this.subscriptions[t]=this.subscriptions[t]||[],this.subscriptions[t].push(s),i.bind(this,s)}},{key:"send",value:function(t,i,n,r){r=e(n,"Function")?n:r||function(){},n=e(n,"Object")?n:{throwOnMissing:!0},new o(this.subscriptions).withName("all",s(t,r)).dispatch(t,{throwOnMissing:!1}).withName(t,s(i,r)).dispatch(t,n)}},{key:"reset",value:function(){this.subscriptions={}}}]),t}(),c=function a(t,i){_classCallCheck(this,a),this.id="#"+Math.floor(16777215*Math.random()).toString(16),this.box=n(t),this.handler=i},o=function(){function t(i){_classCallCheck(this,t),this.subscriptions=i}return _createClass(t,[{key:"withName",value:function(t,i){var s,e=new RegExp(t),r=[];for(var c in this.subscriptions)s=new RegExp(n(c)),(e.exec(n(c))||s.exec(n(t)))&&r.push(this.subscriptions[c]);return new u(r,i,this)}}]),t}(),u=function(){function t(i,n,s){_classCallCheck(this,t),this.receivers=i,this.callback=n,this.context=s}return _createClass(t,[{key:"dispatch",value:function(t,i){var n=this;if(0===this.receivers.length&&i.throwOnMissing===!0)throw"Courier: No receiver registered for '"+t+"'";return this.receivers.forEach(function(t){n.callback(t)}),this.context}}]),t}();t.Courier=r}(window);