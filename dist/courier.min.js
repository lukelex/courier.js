"use strict";var _classCallCheck=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function t(t,n){for(var i=0;i<n.length;i++){var e=n[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,i,e){return i&&t(n.prototype,i),e&&t(n,e),n}}();!function(t){function n(t){this.subscriptions[t.box]=this.subscriptions[t.box].filter(function(n){return n.id!==t.id}),0===this.subscriptions[t.box].length&&delete this.subscriptions[t.box]}function i(t){return t.id="#"+Math.floor(16777215*Math.random()).toString(16),t}function e(t){return t.toString().replace(/(^\/|\/$)/g,"")}function s(t,n){var i=[];return function(e){return e.forEach(function(n){i.push(n.opener(t))}),n(i)}}function r(t,n){return t&&{}.toString.call(t)==="[object "+n+"]"}var c=function(){function t(){_classCallCheck(this,t),this.subscriptions={}}return _createClass(t,[{key:"receive",value:function(t,s){var r=i({box:e(t),opener:s});return this.subscriptions[t]=this.subscriptions[t]||[],this.subscriptions[t].push(r),n.bind(this,r)}},{key:"send",value:function(t,n,i,e){e=r(i,"Function")?i:e||function(){},i=r(i,"Object")?i:{throwOnMissing:!0},new o(this.subscriptions).withName("all",s(t,e)).dispatch(t,{throwOnMissing:!1}).withName(t,s(n,e)).dispatch(t,i)}},{key:"reset",value:function(){this.subscriptions={}}}]),t}(),o=function(){function t(n){_classCallCheck(this,t),this.subscriptions=n}return _createClass(t,[{key:"withName",value:function(t,n){var i,s=new RegExp(t),r=[];for(var c in this.subscriptions)i=new RegExp(e(c)),(s.exec(e(c))||i.exec(e(t)))&&r.push(this.subscriptions[c]);return new u(r,n,this)}}]),t}(),u=function(){function t(n,i,e){_classCallCheck(this,t),this.receivers=n,this.callback=i,this.context=e}return _createClass(t,[{key:"dispatch",value:function(t,n){var i=this;if(0===this.receivers.length&&n.throwOnMissing===!0)throw"Courier: No receiver registered for '"+t+"'";return this.receivers.forEach(function(t){i.callback(t)}),this.context}}]),t}();t.Courier=c}(window);